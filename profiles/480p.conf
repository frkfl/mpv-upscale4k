[lowres]
profile-cond=width < 800

# Restoration profile (noisy VHS, DV, TV captures). Will lower DVD quality a bit
af=highpass=f=99,lowpass=f=16001,dynaudnorm=f=251:g=15:p=0.8,crystalizer=3,alimiter

# A — Analog Repair
# Deinterlace
deinterlace=auto
# Deterministic OkLab (Björn Ottosson) BT.601/709 → BT.2020 normalizer
glsl-shaders-append="~~/shaders/autocolormatrix.glsl"
# Front-End — Remove most of the common analog insanity
glsl-shaders-append="~~/shaders/normalize_frontend.glsl"
glsl-shader-opts=th_low=0.030,th_high=0.10,shift_px=0.80,k_strength=0.58,alpha_yfb=0.12,beta_cfb=0.025,blur_sigma=0.95,protect_gate=0.72,shadow_thresh=0.045,knee_gain=1.0,ema_low=0.15,ema_high=0.55,motion_thr=0.03,s_chroma_protect=0.75,e_ref=0.08,max_desat=0.28
# Post Front-End Stabilizer — optimized (3-tap directional dering, fused stats, stronger shimmering removal).
glsl-shaders-append="~~/shaders/post_frontend_stabilizer.glsl"
glsl-shader-opts=dering_sigma=0.85,dering_mix_max=0.30,agc_gamma=0.6,agc_k0=0.02,agc_k1=0.35,agc_delta_max=0.25,agc_scale_kappa=0.9,unclip_shadow_power=0.88,unclip_highlight_power=1.05,unclip_eta_fill=0.03,hue_cap_deg_skin=3.0,hue_cap_deg_global=5.0,sat_cap_skin=0.12,sat_cap_global=0.20,meanY_guard_pct=0.005,ring_kappa=0.5,ring_gain=3.0,protect_grad_lo=0.06,protect_grad_hi=0.16,motion_lo=0.01,motion_hi=0.03,highlights_gate_Y=0.85
# Temporal Stabilizer — suppress horizontal shimmer - Deterministic
glsl-shaders-append="~~/shaders/temporal_stabilizer.glsl"
glsl-shader-opts=gx_thresh=0.04,gy_thresh=0.25,alpha_base=0.30,luma_gate_lo=0.05,luma_gate_hi=0.90,luma_gate_strength=0.10,phase_offset_px=0.0,blur_sigma=0.15
# Structural Cleaning Reinforcement Pass (Full-Power, Perceptual)
glsl-shaders-append="~~/shaders/struct_clean_fullpower.glsl"
glsl-shader-opts=strength=3.0,radius=5.0,edge_protect=0.20,chroma_weight=1.0,temporal_alpha=1.0,global_gain=3.0
# Edge Stabilization & Perceptual Phase Re-Alignment v2 (deterministic, perceptually tunable)
glsl-shaders-append="~~/shaders/edge_phase_realign_v2.glsl"
glsl-shader-opts=strength=2.0,edge_gain=4.0,edge_exp=3.0,phase_max=0.8,amp_norm=0.5,tangential_smooth=0.5,temporal_alpha=0.3,global_gain=3.0,skin_protect=0.0
# A not very fancy hdeband for hi8 8x8 macro blocks
glsl-shaders-append="~~/shaders/hi8_deblock.glsl"
# Mild Clean+BlockFix (edge-aware denoise + flat deblock + dering + stochastic gating)
glsl-shaders-append="~~/shaders/mild_clean_blockfix.glsl"
glsl-shader-opts=clean_strength=1.00

# Smoothing and entropy
# AA in low resolution
glsl-shaders-append="~~/shaders/smaa.glsl"
glsl-shader-opts=edge_strength=0.35,corner_strength=0.42,gamma=1.0
# Add some texturing to uniform colors - anti plastic
glsl-shaders-append="~~/shaders/texture_classify.glsl"
# Light temporal texture
glsl-shaders-append="~~/shaders/temporal_blue_grain.glsl"
glsl-shader-opts=strength=0.01,chroma=0.5,grain_size=1.2
glsl-shaders-append="~~/shaders/temporal_blue_grain.glsl"
glsl-shader-opts=strength=0.020,chroma=0.5,grain_size=1.2
glsl-shaders-append="~~/shaders-dl/noise_static_luma.hook"


# Details additions
glsl-shaders-append="~~/shaders-dl/skin_texture_amplifier.glsl"
# Details additions
glsl-shaders-append="~~/shaders/micro_detail_luma.glsl"
glsl-shader-opts=strength=0.28,threshold=0.004
# Skin Detail Enhancer (skin-gated luma microtexture, grain-free output)
glsl-shaders-append="~~/shaders/skin_detail_luma.glsl"
glsl-shader-opts=strength=0.18,skin_hue=0.075,skin_width=0.070,skin_soft=0.030,freq=1.25,anisotropy=0.55

#glsl-shaders-append="~~/shaders-dl/LumaSharpen.glsl"
#glsl-shaders-append="~~/shaders-dl/adaptive_sharpen_RT.glsl"
# Deband
glsl-shaders-append="~~/shaders/nlmeans_super_light.glsl"
glsl-shaders-append="~~/shaders-dl/hdeband.glsl"
# Add some texturing to uniform colors - anti plastic
glsl-shaders-append="~~/shaders/texture_classify.glsl"
# Light temporal texture
glsl-shaders-append="~~/shaders/temporal_blue_grain.glsl"
glsl-shader-opts=strength=0.01,chroma=0.5,grain_size=1.2
glsl-shaders-append="~~/shaders/temporal_blue_grain.glsl"
glsl-shader-opts=strength=0.020,chroma=0.5,grain_size=1.2
glsl-shaders-append="~~/shaders-dl/noise_static_luma.hook"
# Details additions
glsl-shaders-append="~~/shaders-dl/skin_texture_amplifier.glsl"

# Details additions
glsl-shaders-append="~~/shaders-dl/skin_texture_amplifier.glsl"
# Details additions
glsl-shaders-append="~~/shaders/micro_detail_luma.glsl"
glsl-shader-opts=strength=0.28,threshold=0.004
# Skin Detail Enhancer (skin-gated luma microtexture, grain-free output)
glsl-shaders-append="~~/shaders/skin_detail_luma.glsl"
glsl-shader-opts=strength=0.18,skin_hue=0.075,skin_width=0.070,skin_soft=0.030,freq=1.25,anisotropy=0.55

# Texture Balance Map (TBM) – pre-upscale texture density equalization
glsl-shaders-append="~~/shaders/tbm.glsl"
glsl-shader-opts=tbm_base_strength=0.011,tbm_a_low=0.010,tbm_a_high=0.140

# C - Upscaling 4K
glsl-shaders-append="~~/shaders-dl/CfL_Prediction_RT.glsl"
glsl-shaders-append="~~/shaders-dl/KrigBilateral.glsl"
glsl-shaders-append="~~/shaders-dl/SSimSuperRes_RT.glsl"
glsl-shaders-append="~~/shaders-dl/FSRCNNX_x2_8-0-4-1.glsl"
#glsl-shaders-append="~~/shaders/smart_upscale_mix.glsl"
#glsl-shader-opts=fsrn_base=0.15,edge_boost=2.40,flat_protect=0.25,sigma_s=1.00,sigma_r=0.075
glsl-shaders-append="~~/shaders-dl/SSimDownscaler.glsl"
# Post-sharpen anti-ringing mop-up
#glsl-shaders-append="~~/shaders/ringing_guard.glsl"
#glsl-shader-opts='strength=0.85:radius=1.5:gamma_in=1.0:gamma_out=1.0:lobe_strength=0.65:lobe_threshold=0.015:lobe_priority=0.65:delta_cap=0.5:apply_threshold=0.02'
# Edge AA (stabilizes FSR/SSim ringing in motion)
glsl-shaders-append="~~/shaders/smaa.glsl"
glsl-shader-opts=edge_strength=0.85,corner_strength=0.42,gamma=1.0
# Edge AA (stabilizes FSR/SSim ringing in motion)
glsl-shaders-append="~~/shaders/smaa.glsl"
glsl-shader-opts=edge_strength=0.45,corner_strength=0.22,gamma=1.0

# Full Color range improvement
glsl-shaders-append="~~/shaders/fullrange_improve.glsl"
#HDR-safe OkLCH vibrance
#glsl-shaders-append="~~/shaders/oklch_vibrance.glsl"
#glsl-shader-opts=vibrance=0.22,skin_protect=0.55,skin_hue=0.07,skin_width=0.08,mid_bias=0.50,gamma_in=1.0,gamma_out=1.05,chroma_tame=0.10
# A slight pop of color, not quite HDR, but a bit of punch
#glsl-shaders-append="~~/shaders/chroma_pop.glsl"
#glsl-shader-opts=amount=0.08,radius=1.0,clamp_c=0.05,gamma_in=1.0,gamma_out=1.0
# Lifting shadows
#glsl-shaders-append="~~/shaders/shadow_lift.glsl"


# Quality improvements
glsl-shaders-append="~~/shaders/smaa.glsl"
glsl-shader-opts=edge_strength=0.68,corner_strength=0.22,gamma=1.0
# Temporal sharpen (TXAA-lite; keep modest)
glsl-shaders-append="~~/shaders/temporal_sharpen.glsl"
glsl-shader-opts=strength=1.50,motion_sense=0.65,decay=0.85,radius=1.0,clamp_amt=0.028,thresh=0.018,gamma_in=1.0,gamma_out=1.0
# Hair-aware sharpen (detail recovery)
glsl-shaders-append="~~/shaders/hair_aware_sharpen.glsl"
glsl-shader-opts=sharp_amt=0.64,hf_gain=1.65,flat_guard=0.92,temp_sense=0.68,clamp_amt=0.026
# Edge-aware sharpen — **reined in** but still strong
glsl-shaders-append="~~/shaders/masked_sharpen.glsl"
glsl-shader-opts=strength=0.40,clamp_amt=0.038,edge_low=0.02,edge_high=0.24,flat_protect=0.88,motion_gate=0.65,gamma_in=1.0,gamma_out=1.0
# Temporal sharpen — **calmer in motion**
glsl-shaders-append="~~/shaders/temporal_sharpen.glsl"
glsl-shader-opts=strength=0.36,motion_sense=0.80,decay=0.90,radius=1.0,clamp_amt=0.034,thresh=0.020,gamma_in=1.0,gamma_out=1.0
# Micro-contrast — a touch less
glsl-shaders-append="~~/shaders/micro_contrast.glsl"
glsl-shader-opts=radius=0.8,amount=0.12,threshold=0.02,gamma_in=1.0,gamma_out=1.0

# Mild Clean+BlockFix (edge-aware denoise + flat deblock + dering + stochastic gating)
glsl-shaders-append="~~/shaders/mild_clean_blockfix.glsl"
glsl-shader-opts=clean_strength=0.25

# Details additions
# Hair-aware sharpen (detail recovery)
glsl-shaders-append="~~/shaders/hair_aware_sharpen.glsl"
glsl-shader-opts=sharp_amt=0.64,hf_gain=1.65,flat_guard=0.92,temp_sense=0.68,clamp_amt=0.026
# Details additions
glsl-shaders-append="~~/shaders-dl/skin_texture_amplifier.glsl"
# Micro Detail Enhancer (Luma-only, edge-gated)
glsl-shaders-append="~~/shaders/micro_detail_luma.glsl"
glsl-shader-opts=strength=0.28,threshold=0.004
# Skin Detail Enhancer (skin-gated luma microtexture, grain-free output)
glsl-shaders-append="~~/shaders/skin_detail_luma.glsl"
glsl-shader-opts=strength=0.18,skin_hue=0.075,skin_width=0.070,skin_soft=0.030,freq=1.25,anisotropy=0.55
# Add some texturing to uniform colors - anti plastic
glsl-shaders-append="~~/shaders/texture_classify.glsl"

#glsl-shaders-append="~~/shaders-dl/LumaSharpen.glsl"
#glsl-shaders-append="~~/shaders-dl/adaptive_sharpen_RT.glsl"

# Light temporal texture
glsl-shaders-append="~~/shaders/temporal_blue_grain.glsl"
glsl-shader-opts=strength=0.01,chroma=0.5,grain_size=1.2
glsl-shaders-append="~~/shaders/temporal_blue_grain.glsl"
glsl-shader-opts=strength=0.020,chroma=0.5,grain_size=1.2


# Very light regular CRT like effect
glsl-shaders-append="~~/shaders/crt_natural.glsl"
glsl-shader-opts=scan_amp=0.82,scan_curve=1.20,bloom_strength=0.30,bloom_radius=1.35,mask_strength=0.42,mask_soft=0.60,chroma_preserve=0.92,sat_boost=1.06,black_lift=0.015,gamma_in=1.0,gamma_out=1.0

