[lowres]
profile-cond=width < 800

# --- SD color fix (keep gentle; linear pipeline needs less push) ---
vf=format:colormatrix=bt.601:primaries=bt.601:colorspace=bt.601:colorlevels=full,\
lavfi="eq=contrast=1.30:saturation=1.10:gamma=1.20"

# Native-res cleanup (safe for later learned upscalers)
#vf-append=atadenoise=0a=0:0b=0:1a=6:1b=6:2a=6:2b=6
#vf-append=deblock=alpha=3:beta=3

glsl-shader=~~/shaders/mild_cleanup.glsl
glsl-shader-opts=LUMA_RADIUS=2.0:SIGMA_S=2.5:SIGMA_R=0.12:CHROMA_RADIUS=2.0:CHROMA_STRENGTH=0.85:DEBLOCK_STRENGTH=0.55:GRAIN_STRENGTH=0.009

glsl-shaders-clr

# Upscale
glsl-shaders-append=~~/shaders-dl/CfL_Prediction_RT.glsl
glsl-shaders-append=~~/shaders-dl/KrigBilateral.glsl
glsl-shaders-append=~~/shaders-dl/FSRCNNX_x2_8-0-4-1.glsl
glsl-shaders-append=~~/shaders-dl/SSimSuperRes_RT.glsl

# Analogize
# Tiny shadow lift so near-black tones keep chroma (linear variant)
glsl-shaders-append="~~/shaders/lift_shadows.glsl?lift=0.020&pivot=0.10&softness=3.0&gamma_in=1.0&gamma_out=1.0"
# Bold CRT prepass (soft mask helps coherent SSIM collapse)
glsl-shaders-append="~~/shaders/crt_natural.glsl?scan_amp=0.36&scan_curve=1.20&bloom_strength=0.10&bloom_radius=1.35&mask_strength=0.05&mask_soft=0.60&chroma_preserve=0.92&sat_boost=1.06&black_lift=0.015&gamma_in=1.0&gamma_out=1.0"
# Entropy + static noise to break codec blocks before downscale
glsl-shaders-append="~~/shaders/micro_entropy_grain.glsl?strength=0.009&chroma=0.2&grain_size=1.3&midtone_bias=0.75&animate=1"
glsl-shaders-append=~~/shaders-dl/noise_static_luma.hook
glsl-shaders-append=~~/shaders-dl/noise_static_luma.glsl
glsl-shaders-append=~~/shaders-dl/noise_static_chroma.glsl

# 1080p downscale and cleaning
vf-append=scale=1920:1080:flags=ssim
vf-append=unsharp=5:5:0.2
glsl-shaders-append="~~/shaders-dl/nlmeans_light.glsl"
glsl-shaders-append="~~/shaders-dl/hdeband.glsl"

# Final 4K Upscale - hopefully from a better place...
glsl-shaders-append="~~/shaders-dl/CfL_Prediction_RT.glsl"
glsl-shaders-append="~~/shaders-dl/KrigBilateral.glsl"
glsl-shaders-append="~~/shaders-dl/FSRCNNX_x2_8-0-4-1.glsl"
glsl-shaders-append="~~/shaders-dl/SSimSuperRes_RT.glsl"

# Quality
# Edge AA first (stabilizes FSR/SSim ringing in motion)
glsl-shaders-append="~~/shaders/smaa.glsl?edge_strength=0.40&corner_strength=0.25"

# Sweat/specular guard (prevents plasticky hotspots on dark skin)
glsl-shaders-append="~~/shaders/specular_guard.glsl?knee_start=0.70&knee_strength=0.30&blur_amt=0.10&sat_thresh=0.18&warm_sheen=0.03&gamma_in=1.0&gamma_out=1.0"

# Midtone-only detail (pores/texture; skips highlights/shadows)
glsl-shaders-append="~~/shaders/midtone_detail.glsl?amount=0.28&low=0.12&high=0.65&clamp_amt=0.025&radius=1.0&gamma_in=1.0&gamma_out=1.0"

# Edge-aware sharpen (no halos, protects flats)
glsl-shaders-append="~~/shaders/masked_sharpen.glsl?strength=0.32&clamp_amt=0.025&edge_low=0.02&edge_high=0.20&flat_protect=0.85&motion_gate=0.6&gamma_in=1.0&gamma_out=1.0"

# Temporal sharpen (TXAA-lite; motion-aware, halo-clamped)
glsl-shaders-append="~~/shaders/temporal_sharpen.glsl?strength=0.25&motion_sense=0.6&decay=0.8&radius=1.0&clamp_amt=0.030&thresh=0.020&gamma_in=1.0&gamma_out=1.0"

# Micro-contrast (depth/pop without edge halos)
glsl-shaders-append="~~/shaders/micro_contrast.glsl?radius=1.0&amount=0.12&threshold=0.02&gamma_in=1.0&gamma_out=1.0"

# Tone
glsl-shaders-append="~~/shaders/color_expand_log_adaptive.glsl:black_level=0.062561:white_level=0.918367:log_strength=12.0:exponent_weight=0.85:adapt_floor=0.68:adapt_ceiling=1.18:adapt_pivot=0.18:adapt_contrast=0.60:chroma_preserve=0.15:soft_knee=0.02"
glsl-shaders-append="~~/shaders/vibrance_oklab.glsl?vibrance=0.18&skin_protect=0.6&mid_bias=0.20&gamma_in=1.0&gamma_out=1.0"
glsl-shaders-append="~~/shaders/chroma_pop.glsl?amount=0.10&radius=1.1&clamp_c=0.05&gamma_in=1.0&gamma_out=1.0"
glsl-shaders-append="~~/shaders/skin_tone_tamer.glsl?strength=0.35&hue_center=0.07&hue_width=0.12&L_low=0.45&L_high=0.85"


# === Attempt at texturing WIP
#glsl-shaders-append="~~/shaders/texture_classify.glsl"
#glsl-shaders-append="~~/shaders/structured_grain.glsl?strength=0.030&blue_ratio=0.85&grain_px=1.2&skin_orient=0.15&cloth_orient=0.35&luma_weight=0.85"

# Analogize
# visible CRT feel (color-preserving; linear)
glsl-shaders-append="~~/shaders/crt_natural.glsl?scan_amp=0.26&scan_curve=1.35&bloom_strength=0.06&bloom_radius=1.25&mask_strength=0.18&mask_soft=0.25&chroma_preserve=0.85&sat_boost=1.08&black_lift=0.012&gamma_in=1.0&gamma_out=1.0"

# temporal blue-noise (fine + sparse)
glsl-shaders-append="~~/shaders/temporal_blue_grain.glsl?strength=0.030&chroma=0.6&grain_size=1.0"
glsl-shaders-append="~~/shaders/temporal_blue_grain.glsl?strength=0.012&chroma=0.3&grain_size=2.5"

